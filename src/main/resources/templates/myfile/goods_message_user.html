<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>

    <!--<script type="text/javascript" src="js/myindex_v1.js"></script>-->
    <link href="/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link rel="stylesheet" href="/mycss/goods.css"/>
    <link href="/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">
    <link rel="stylesheet" href="/layui/css/layui.css" media="all">

</head>

<body id="body">
<div class="index_v1-main">
    <div class="nav-main">
        <div style="text-align: center;" class="nav-main-check">
            <h1 style="background: #f2f2f2; margin-top: 2px;">个人订单信息页面</h1>
            <p style="background: #f2f2f2; margin-top: -10px;"></p>
        </div>

        <div class="text-data-main">
            <span style="text-align: center;"><h3>已完成的订单信息</h3></span>
            <span class="data-main0"><a class="number">订单号</a></span>
            <span class="data-main0"><a class="market">服务类型</a></span>
            <span class="data-main0"><a class="employee">雇员</a></span>
            <span class="data-main0"><a class="employee">地点</a></span>
            <span class="data-main0"><a class="employee">评分</a></span>
            <span class="data-main1"><a>工作内容简介</a></span>
            <!--<div class="container">1</div>-->
            <span class="data-main2"><a>工作时间</a></span>

            <span class="data-main3"><a>订单状态</a></span>

        </div>

        <div id="finishShow" class="show">
            <!--						<div class="text-data-show">-->
            <!--							<span class="data-main0"><a>1</a></span>-->
            <!--							<span class="data-main0"><a>A1</a></span>-->
            <!--							<span class="data-main1"><a>订单信息的工作内容：保姆</a></span>-->
            <!--							<span class="data-main2"><a>2022/06/18 08:00 ~ 2022/06/18 08:00</a></span>-->
            <!--							<span class="data-main3">已完成</span>-->
            <!--							&lt;!&ndash;<span class="data-main3"><button class="button1 mybut1"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇主ok</div></button><button class="button2 mybut1_2"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇员ok</div></button></span>&ndash;&gt;-->
            <!--						</div>-->
            <!--						<div class="text-data-show">-->
            <!--							<span class="data-main0"><a>1</a></span>-->
            <!--							<span class="data-main0"><a>A1</a></span>-->
            <!--							<span class="data-main1"><a>订单信息的工作内容：保洁</a></span>-->
            <!--							<span class="data-main2"><a>2022/06/18 08:00 ~ 2022/06/18 08:00</a></span>-->
            <!--							<span class="data-main3">已完成</span>-->
            <!--							&lt;!&ndash;<span class="data-main3"><button class="button1 mybut2"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇主ok</div></button><button class="button2 mybut2_2"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇员ok</div></button></span>&ndash;&gt;-->
            <!--						</div>-->
            <!--						<div class="text-data-show">-->
            <!--							<span class="data-main0"><a>1</a></span>-->
            <!--							<span class="data-main0"><a>A1</a></span>-->
            <!--							<span class="data-main1"><a>订单信息的工作内容：家教（数学）</a></span>-->
            <!--							<span class="data-main2"><a>2022/06/18 08:00 ~ 2022/06/18 08:00</a></span>-->
            <!--							<span class="data-main3">已完成</span>-->
            <!--							&lt;!&ndash;<span class="data-main3"><button class="button1 mybut3"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇主ok</div></button><button class="button2 mybut3_2"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇员ok</div></button></span>&ndash;&gt;-->
            <!--						</div>-->
            <!--						<div class="text-data-show">-->
            <!--							<span class="data-main0"><a>1</a></span>-->
            <!--							<span class="data-main0"><a>A1</a></span>-->
            <!--							<span class="data-main1"><a>订单信息的工作内容：保姆（照顾孩子）</a></span>-->
            <!--							<span class="data-main2"><a>2022/06/18 08:00 ~ 2022/06/18 08:00</a></span>-->
            <!--							<span class="data-main3">已完成</span>-->
            <!--							&lt;!&ndash;<span class="data-main3"><button class="button1 mybut4"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇主ok</div></button><button class="button2 mybut4_2"><div class="zindex1"><img class="imgcss2" src="img/write.png">雇员ok</div></button></span>&ndash;&gt;-->
            <!--						</div>-->
        </div>
        <div class="other" style="text-align: center">
            <a class="a_few"> < </a>
            <input type="text" class="number-select" value="1" disabled="disabled"/>
            <a class="a_more"> > </a>&nbsp&nbsp&nbsp
            <div class="other-main">
                到第<input type="text" class="number-find" value="1"/>&nbsp页&nbsp
                <button class="button3" onclick="button3_onclick()">确认</button>
                &nbsp&nbsp&nbsp 共 <a class="a_number"></a> 页&nbsp&nbsp&nbsp
                <select class="number-last">
                    <option>6条/页</option>
                </select>
            </div>
        </div>
    </div>

</div>
</div>

<div id="modal-form1" class="modal fade" aria-hidden="true" style="overflow-y: visible; left: 150px;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 b-r">
                        <h3 class="m-t-none m-b">评价</h3>
                        <p>请你对这次家政服务进行评价</p>
                        <a>worker</a>
                        <p>进行此次评价
                            <select>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                            分
                        </p>
                    </div>
                </div>
            </div>
            <div>
                <button id="mybut_2" onclick="" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="submit">
                    <strong>提交</strong></button>
                <button id="mybut_1" onclick="" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="submit">
                    <strong>取消</strong></button>
            </div>
        </div>
    </div>

</div>
</div>

</body>

</html>
<script src="/js/jquery.min.js"></script>
<script src="/js/plugins/sweetalert/sweetalert.min.js"></script>
<script src="/myjs/user/message/goods_user.js" type="text/javascript"></script>
<script src="/myjs/user/page/Page_jump_goodswork.js" type="text/javascript"></script>
<script src="/myjs/isEmpty.js" type="text/javascript"></script>
<script src="/js/plugins/layer/layer.min.js"></script>
<script src="/js/demo/layer-demo.min.js"></script>
<script src="/layui/layui.js"></script>
<script>
    var myurl = ""
    $.ajax({
        url:"../checkUsers",
        type:"POST",
        datatype:"json",
        contentType:"application/json:charset=UTF-8",
        success:function (dat){
            myurl += dat.data.part
        },
        error:function (e){
            console.log("error")
        }
    })


    var websocket
    //以下为 layim 最新版写法
    layui.config({
        layimPath: '/dist/' //配置 layim.js 所在目录
        ,layimAssetsPath: '/dist/layim-assets/' //layim 资源文件所在目录
    }).extend({
        layim: layui.cache.layimPath + 'layim' //配置 layim 组件所在的路径
    }).use('layim', function(layim){ //加载组件

        layim.on('ready',function (res){
            layui.use('layim',function(layim) {

                if ('WebSocket' in window) {
                    websocket = new WebSocket("ws://localhost:8080/mysocket/" + myurl);
                } else {
                    alert('Not support websocket')
                }
                websocket.onerror = function () {
                    // setMessageInnerHTML("error");
                };
                //连接成功建立的回调方法
                websocket.onopen = function (event) {
                    // websocket.send("连接成功")
                    // setMessageInnerHTML("Loc MSG: 成功建立连接");
                }
                //接收到消息的回调方法
                websocket.onmessage = function (event) {
                    var arr = event.data.split(":")
                    console.log(arr[1])
                    console.log(event)
                    var arr = event.data.split(",")
                    console.log(arr)
                    for (var i=2;i<arr.length;i++){
                        // console.log(arr[i])
                        layim.getMessage({
                            username: arr[1]
                            , id: arr[0]
                            , avatar: ""
                            , type: "friend"
                            , content: arr[i]
                        })
                    }


                }
                //连接关闭的回调方法
                websocket.onclose = function () {
                    // setMessageInnerHTML("Loc MSG:关闭连接");
                }
                //监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。
                window.onbeforeunload = function () {
                    websocket.close();
                }

                layim.on("sendMessage",function (res){
                    // console.log(res)
                    // var mine = res.mine

                    // console.log(mine)

                    // console.log(to)

                    var mine = res.mine.username
                    var message = res.mine.content
                    var to = res.to.id
                    var socketMsg = {msg: message, toUser: to, fromUser: mine};
                    websocket.send(JSON.stringify(socketMsg))
                })


            })
        })


        //先来个客服模式压压精
        layim.config({
            init: {
                url: '../userTalks' //接口地址（返回的数据格式见下文）
                ,type: 'get' //默认get，一般可不填
                // ,data: {} //额外参数
            },
            // init:{
            //     mine:{
            //         "username":"A2"
            //         ,"id": "A2" //我的ID}
            //         ,"status": "online" //在线状态 online：在线、hide：隐身
            //         ,"sign": "测试" //我的签名
            //     },
            //     friend:[{
            //         "groupname": "服务人员列表" //好友分组名
            //         ,"id": 1 //分组ID
            //         ,"list": [{ //分组下的好友列表
            //             "username": "B2" //好友昵称
            //             ,"id": "B2" //好友ID
            //             ,"avatar": "" //好友头像
            //             ,"sign": "这些都是测试数据，实际使用请严格按照该格式返回" //好友签名
            //             ,"status": "online" //若值为offline代表离线，online或者不填为在线
            //         }]
            //     }]
            // },
            title:"老王",
            right:"50px",
            // min:true,
            isgroup: false,
            // brief: true //是否简约模式（如果true则不显示主面板）
        })
    });
    // layim.on('ready', function(options){
    //     console.log(options);
    //     //do something
    //
    // });




</script>